(this["webpackJsonpchat-frontend"]=this["webpackJsonpchat-frontend"]||[]).push([[0],{74:function(t,e,a){},76:function(t,e){function a(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}a.keys=function(){return[]},a.resolve=a,t.exports=a,a.id=76},77:function(t,e,a){"use strict";a.r(e);var s=a(6),n=a.n(s),l=a(35),c=a.n(l),o=a(36),r=a(12),i=a(13),d=a(15),b=a(14),m=a(37),_=(a(74),a(0)),u=function(t){Object(d.a)(a,t);var e=Object(b.a)(a);function a(){return Object(r.a)(this,a),e.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return Object(_.jsxs)("div",{className:"alert alert-".concat(this.props.type," alert-dismissible custom-alert"),role:"alert",children:[Object(_.jsx)("strong",{children:this.props.symbol})," ",this.props.text]})}}]),a}(s.Component),h=a(38),j=a.n(h),f="http://".concat(document.location.hostname,":8000/"),p=Object(m.io)(f),x=function(t){Object(d.a)(a,t);var e=Object(b.a)(a);function a(t){var s;return Object(r.a)(this,a),(s=e.call(this,t)).connect=function(){s.setState({alertContent:Object(_.jsx)(u,{type:"warning",symbol:"Waiting",text:"Please wait for the server reply"}),my_form_disable:!0});var t=new j.a(s.state.my_name,{path:"/chat",host:"/",port:8e3});s.setState({peer:t}),p.emit("username_submit",{username:s.state.my_name}),t.on("call",(function(t){s.setState({call:t,is_calling_one:!0,other_form_disable:!0})}))},s.handleField=function(t){s.setState(Object(o.a)({},t.target.name,t.target.value))},s.change_video=function(){!0===s.state.video_status&&(s.setState({video_status:!1}),s.state.stream.getVideoTracks()[0].enabled=!1),!1===s.state.video_status&&(s.setState({video_status:!0}),s.state.stream.getVideoTracks()[0].enabled=!0)},s.change_audio=function(){!0===s.state.audio_status&&(s.setState({audio_status:!1}),s.state.stream.getAudioTracks()[0].enabled=!1),!1===s.state.audio_status&&(s.setState({audio_status:!0}),s.state.stream.getAudioTracks()[0].enabled=!0)},s.call_user=function(){s.setState({alertContent:Object(_.jsx)(u,{type:"warning",symbol:"Waiting",text:"seaching for the username ."}),other_form_disable:!0}),p.emit("call_user",{my_username:s.state.my_name,other_username:s.state.other_name})},s.answer_call=function(){s.setState({is_calling_one:!1,is_calling_two:!1,call_btn_disabled:!1,other_form_disable:!0,alertContent:Object(_.jsx)(u,{type:"success",symbol:"Call",text:"Accepted the call"})}),p.emit("call_accept",{other_username:s.state.other_name}),s.state.call.answer(s.state.stream),s.state.call.on("stream",(function(t){s.otherdata.current.srcObject=t})),s.state.call.on("close",(function(){s.setState({alertContent:Object(_.jsx)(u,{type:"danger",symbol:"End",text:"Call is ended"}),other_form_disable:!1,call_btn_disabled:!0})}))},s.cut_call=function(){var t;s.state.call.close(),!0===s.state.is_calling_two&&!0===s.state.is_calling_one?t="call_reject":(clearInterval(s.state.call_cut_interval_id),t="call_end"),s.setState({other_form_disable:!1,call_btn_disabled:!0,is_calling_one:!1,is_calling_two:!1,alertContent:Object(_.jsx)(u,{type:"danger",symbol:"Call",text:"Call is ended"})}),p.emit(t,{other_username:s.state.other_name})},s.componentDidMount=function(){navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(t){s.setState({stream:t}),s.owndata.current.srcObject=s.state.stream})).catch((function(t){alert(t)})),p.on("username_submit",(function(t){var e=t.code;"3000"===e&&s.setState({alertContent:Object(_.jsx)(u,{type:"danger",symbol:"Username error",text:"Username is already exist , choose another ."}),my_form_disable:!1}),"2000"===e&&s.setState({alertContent:Object(_.jsx)(u,{type:"success",symbol:"Connect success",text:"Connection is successfully established . You can chat now"}),my_form_disable:!0,other_form_disable:!1})})),p.on("call_user",(function(t){var e=t.code;if("2001"===e){s.setState({alertContent:Object(_.jsx)(u,{type:"success",symbol:"Calling",text:"Calling the user"}),call_btn_disabled:!1});var a=t.other_username,n=s.state.peer.call(a,s.state.stream);s.setState({call:n});var l=setInterval((function(){s.setState({alertContent:Object(_.jsx)(u,{type:"danger",symbol:"Not answering",text:"".concat(s.state.other_name," is not answering your call")}),other_form_disable:!1,call_btn_disabled:!0}),p.emit("call_end",{other_username:s.state.other_name})}),2e4);s.setState({call_cut_interval_id:l}),s.state.call.on("stream",(function(t){s.otherdata.current.srcObject=t})),s.state.call.on("close",(function(){s.setState({alertContent:Object(_.jsx)(u,{type:"danger",symbol:"End",text:"Call is ended"}),other_form_disable:!1,call_btn_disabled:!0})}))}"2002"===e&&s.setState({other_name:t.other_username,is_calling_two:!0,other_form_disable:!0,alertContent:Object(_.jsx)(_.Fragment,{})}),"3001"===e&&s.setState({alertContent:Object(_.jsx)(u,{type:"danger",symbol:"Not found",text:"Username is not found"}),other_form_disable:!1})})),p.on("call_accept",(function(){s.setState({call_btn_disabled:!1,other_form_disable:!0}),clearInterval(s.state.call_cut_interval_id)})),p.on("call_end",(function(){s.setState({alertContent:Object(_.jsx)(u,{type:"danger",symbol:"End",text:"Call is ended"}),other_form_disable:!1,call_btn_disabled:!0,is_calling_one:!1,is_calling_two:!1})})),p.on("call_reject",(function(){s.setState({alertContent:Object(_.jsx)(u,{type:"danger",symbol:"Reject",text:"".concat(s.state.other_name," is not answering your call")}),other_form_disable:!1,call_btn_disabled:!0})}))},s.state={call_cut_interval_id:"",audio_status:!0,video_status:!0,call:null,peer:null,stream:null,call_btn_disabled:!0,is_calling_one:!1,is_calling_two:!1,recepient:"",my_name:"",other_name:"",alertContent:Object(_.jsx)(_.Fragment,{}),my_form_disable:!1,other_form_disable:!0},s.owndata=n.a.createRef(),s.otherdata=n.a.createRef(),s}return Object(i.a)(a,[{key:"render",value:function(){return Object(_.jsxs)(s.Fragment,{children:[this.state.alertContent,!0===this.state.is_calling_one&&!0===this.state.is_calling_two?Object(_.jsxs)("div",{className:"mt-4 custom-container rounded row navbar-dark bg-dark",children:[Object(_.jsx)("div",{className:"col-lg-8 col-11",children:Object(_.jsxs)("p",{className:"fs-2 text-light",children:[Object(_.jsx)("strong",{className:"fs-2",children:this.state.other_name})," is calling you ."]})}),Object(_.jsxs)("div",{className:"col-lg-4 col-11",children:[Object(_.jsx)("button",{className:"col-2 btn btn-primary fs-4 m-1",onClick:this.answer_call,children:Object(_.jsx)("i",{class:"fas fa-phone"})}),Object(_.jsx)("button",{className:"col-2 btn btn-danger fs-4 m-1",onClick:this.cut_call,children:Object(_.jsx)("i",{class:"fas fa-phone-slash"})})]})]}):Object(_.jsx)(_.Fragment,{}),Object(_.jsxs)("div",{className:"row justify-content-around mt-4 custom-container",children:[Object(_.jsx)("div",{className:"col-lg-6 col-11",children:Object(_.jsxs)("div",{class:"input-group mb-3",children:[Object(_.jsx)("span",{class:"input-group-text",id:"basic-addon1",children:"Your name"}),Object(_.jsx)("input",{type:"text",class:"form-control",placeholder:"Username","aria-label":"Username","aria-describedby":"basic-addon1",value:this.state.my_name,name:"my_name",onChange:this.handleField,disabled:this.state.my_form_disable}),Object(_.jsx)("button",{className:"btn btn-primary fs-4 col-2",onClick:this.connect,disabled:this.state.my_form_disable,children:Object(_.jsx)("i",{class:"fas fa-plug"})})]})}),Object(_.jsx)("div",{className:"col-lg-6 col-11",children:Object(_.jsxs)("div",{class:"input-group mb-3",children:[Object(_.jsx)("span",{class:"input-group-text",id:"basic-addon1",children:"Other name"}),Object(_.jsx)("input",{type:"text",class:"form-control",placeholder:"Username","aria-label":"Username","aria-describedby":"basic-addon1",value:this.state.other_name,name:"other_name",onChange:this.handleField,disabled:this.state.other_form_disable}),Object(_.jsx)("button",{className:"col-2 btn btn-primary fs-4",onClick:this.call_user,disabled:this.state.other_form_disable,children:Object(_.jsx)("i",{class:"fas fa-phone"})})]})})]}),Object(_.jsxs)("div",{className:"row justify-content-around mt-4 custom-container",children:[Object(_.jsx)("div",{className:"col-lg-4 col-10 rounded p-2 custom-video-box",children:Object(_.jsx)("video",{className:"custom-video-player",ref:this.owndata,autoPlay:!0,muted:!0})}),Object(_.jsx)("div",{className:"col-lg-4 col-10 rounded p-2 custom-video-box",children:Object(_.jsx)("video",{className:"custom-video-player",ref:this.otherdata,autoPlay:!0})})]}),Object(_.jsxs)("div",{className:"row justify-content-around mt-4 custom-container",children:[Object(_.jsx)("button",{className:"col-2 btn ".concat(!0===this.state.video_status?"btn-primary":"btn-danger"," fs-2 p-2"),onClick:this.change_video,children:Object(_.jsx)("i",{class:"fas fa-video"})}),Object(_.jsx)("button",{className:"col-2 btn ".concat(!0===this.state.audio_status?"btn-primary":"btn-danger"," fs-2 p-2"),onClick:this.change_audio,children:Object(_.jsx)("i",{class:"fas fa-volume-up"})}),Object(_.jsx)("button",{className:"col-2 btn btn-primary fs-2 p-2",onClick:this.cut_call,disabled:this.state.call_btn_disabled,children:Object(_.jsx)("i",{class:"fas fa-phone-slash"})})]})]})}}]),a}(s.Component),g=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,78)).then((function(e){var a=e.getCLS,s=e.getFID,n=e.getFCP,l=e.getLCP,c=e.getTTFB;a(t),s(t),n(t),l(t),c(t)}))};c.a.render(Object(_.jsx)(x,{}),document.getElementById("root")),g()}},[[77,1,2]]]);
//# sourceMappingURL=main.71f558c3.chunk.js.map